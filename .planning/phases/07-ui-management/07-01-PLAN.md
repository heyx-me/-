# Phase 7: UI: Management - Implementation Plan

## Goal
Build a functional sidebar for conversation management, implement agent-driven auto-titling, and ensure sorting/UX is polished.

## 1. Database & Schema
- [ ] **SQL-01**: `updated_at` Triggers
  - Create a Postgres trigger to update `conversations.updated_at` whenever a new row is inserted into `messages` for that conversation.
  - Create a trigger to auto-update `updated_at` on the `conversations` table itself.

## 2. Frontend: Sidebar (Drawer)
- [ ] **UI-01**: Sidebar Component
  - Create a `Sidebar` component in `app.jsx`.
  - Use `Framer Motion` for slide-in/out animations (from the left).
  - Use `Lucide React` for icons (MessageSquare, Plus, User, Trash).
- [ ] **UI-02**: Conversation List
  - Fetch conversations where `user_id` is a member.
  - Group by date: "Today", "Yesterday", "Previous 7 Days", "Older".
  - Handle active/hover states.
- [ ] **UI-03**: Management Actions
  - "New Chat" button (Redirects to `?thread=new`).
  - "Delete Chat" button (Owner only, with confirmation).
- [ ] **UI-04**: Identity Footer
  - Show `userId` (truncated) at the bottom.
  - Add "Copy ID" button.

## 3. Backend: Auto-titling
- [ ] **AGT-01**: Titling Logic in `agent.js`
  - After sending a reply, check if the current conversation title is "New Chat".
  - If message count >= 3, trigger a silent summary call to Gemini.
  - Update `conversations.title` with the result.

## 4. Verification
- [ ] **VER-01**: Test Sidebar Toggle (Drawer should slide in/out correctly).
- [ ] **VER-02**: Test Switching Threads (URL and context update).
- [ ] **VER-03**: Test Auto-titling (Start a chat -> 3 msgs -> Sidebar title updates).
